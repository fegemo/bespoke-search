/*! bespoke-search v1.0.0 © 2015 Flávio, MIT License */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n=n.bespoke||(n.bespoke={}),n=n.plugins||(n.plugins={}),n.search=e()}}(function(){var e;return function n(e,r,t){function o(a,s){if(!r[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var f=r[a]={exports:{}};e[a][0].call(f.exports,function(n){var r=e[a][1][n];return o(r?r:n)},f,f.exports,n,e,r,t)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<t.length;a++)o(t[a]);return o}({1:[function(e,n,r){"use strict";function t(e){if(Array.isArray(e)){for(var n=0,r=Array(e.length);n<e.length;n++)r[n]=e[n];return r}return Array.from(e)}n.exports=function(){var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],r=n.showKey,o=void 0===r?"ctrl-f":r,i=n.dismissKey,a=void 0===i?"escape":i,s=n.triggerKey,u=void 0===s?"enter":s,c=n.nextKey,f=void 0===c?["f3","tab"]:c,l=n.prevKey,p=void 0===l?["shift-f3","shift-tab"]:l,d=function(e){return Array.isArray(e)?e:[e]};return o=d(o),a=d(a),u=d(u),f=d(f),p=d(p),function(n){var r,i,s,c,l=e("keymage"),d=[],h=n.slides.map(function(e,n){return{i:n,text:e.textContent}}),v=function(){var e=new Set;d.forEach(function(n){var r=document.createTextNode(n.el.innerText);e.add(n.el.parentNode),n.el.parentNode.replaceChild(r,n.el)}),e.forEach(function(e){return e.normalize()}),d.length=0},g=function(e){e.preventDefault(),r.classList.add("bespoke-search-searching"),r.classList.remove("bespoke-search-no-result"),i.focus(),l.pushScope("searching"),n.parent.classList.add("bespoke-bullet-off")},m=function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),i.value="",s.innerText="",r.classList.remove("bespoke-search-searching"),r.classList.remove("bespoke-search-no-result"),l.popScope(),v(),n.parent.classList.remove("bespoke-bullet-off")},y=function(){s.innerText=d.length>0?c+1+"/"+d.length:"",r.classList.toggle("bespoke-search-no-result",0===d.length)},k=function(e){var r=d[e]||{},t=d[c]||{},o=r.slideIndex;n.slide(o),t&&t.el&&t.el.classList.remove("bespoke-search-result-focused"),r&&r.el&&r.el.classList.add("bespoke-search-result-focused"),c=e,y()},b=function(e){var n=(c+e+d.length)%d.length;k(n)},w=function(){var e=i.value.trim();if(""!==e){var r=new RegExp(e,"i"),o=h.filter(function(e){return r.test(e.text)}),a=function c(e,n){var o=[];switch(e.nodeType){case Node.TEXT_NODE:r.test(e.data)&&(o=n(e));break;case Node.ELEMENT_NODE:var i=!0,a=!1,s=void 0;try{for(var u,f=Array.from(e.childNodes)[Symbol.iterator]();!(i=(u=f.next()).done);i=!0){var l,p=u.value;(l=o).push.apply(l,t(c(p,n)))}}catch(d){a=!0,s=d}finally{try{!i&&f["return"]&&f["return"]()}finally{if(a)throw s}}}return o},u=function(n){var r=n.parentNode,t=function(){var r=n.data.replace(new RegExp("("+e+")","gi"),'<span class="bespoke-search-result">$1</span>'),t=document.createElement("div"),o=document.createDocumentFragment();for(t.innerHTML=r;t.firstChild;)o.appendChild(t.firstChild);return o}(),o=t.querySelectorAll(".bespoke-search-result");return r.insertBefore(t,n),r.removeChild(n),Array.from(o)};d=o.reduce(function(e,r){var t=n.slides[r.i],o=a(t,u).map(function(e){return{slideIndex:r.i,el:e}});return e.concat(o)},[]),s.innerText="1/"+d.length,k(0)}},x=function(){r=document.createElement("div"),i=document.createElement("input"),s=document.createElement("span"),r.id="bespoke-search",i.id="bespoke-search-input",i.type="search",s.id="bespoke-search-results-count",s.innerText="",r.appendChild(i),r.appendChild(s),n.parent.parentNode.appendChild(r)};o.forEach(function(e){return l(e,g)}),a.forEach(function(e){return l("searching",e,m)}),u.forEach(function(e){return l("searching",e,function(){return v(),w(),!1})}),f.forEach(function(e){return l("searching",e,b.bind(e,1),{preventDefault:!0})}),p.forEach(function(e){return l("searching",e,b.bind(e,-1),{preventDefault:!0})}),n.parent.parentNode.addEventListener("keydown",function(e){"bespoke-search-input"===e.target.id&&e.which>=32&&e.stopPropagation()}),x()}}},{keymage:2}],2:[function(n,r,t){!function(e,n){e(function(){function e(e){var n=e.split("-"),r=n[n.length-1],t={code:k[r]};if(!t.code)throw'Unknown key "'+r+'" in keystring "'+e+'"';for(var o,i=0;i<n.length-1;i++){if(r=n[i],o=g[r],!o)throw'Unknown modifier "'+r+'" in keystring "'+e+'"';t[o]=!0}return t}function r(e){for(var n="",r=0;r<m.length;r++)e[m[r]]&&(n+=m[r]+"-");return n+=b[e.code]}function t(n){for(var t=[],o=n.split(" "),i=0;i<o.length;i++){var a=e(o[i]);a=r(a),t.push(a)}return t.original=n,t}function o(e){for(var n={code:e.keyCode},t=0;t<v.length;t++){var o=v[t];e[o]&&(n[o.slice(0,o.length-3)]=!0)}return r(n)}function i(e,n){for(var r=0;r<n.length;r++){var t=n[r];if(t&&(e=e[t]),!e)break}return e}function a(e){if(!~y.indexOf(e.keyCode)){var n=L.slice();n.push(o(e));for(var r,t,a,s=E.split("."),u=s.length;u>=0;u--)if(t=i(C,s.slice(0,u))){r=!0;for(var c=0;c<n.length;c++){if(a=n[c],!t[a]){r=!1;break}t=t[a]}if(r)break}var f=s.slice(0,u).join("."),l=t.preventDefault;if(r&&!t.handlers)return L=n,void(l&&e.preventDefault());if(r)for(u=0;u<t.handlers.length;u++){var p=t.handlers[u],d=p._keymage,h=p.call(d.context,e,{shortcut:d.original,scope:E,definitionScope:f});(h===!1||l)&&e.preventDefault()}L=[]}}function s(e,n,r){var t=e.split("."),o=C;t=t.concat(n);for(var i=0,a=t.length;a>i;i++){var s=t[i];if(s&&(o=o[s]||(o[s]={}),r&&r._keymage.preventDefault&&(o.preventDefault=!0),i===a-1)){var u=o.handlers||(o.handlers=[]);return u}}}function u(e,n,r){var t=s(e,n,r);t.push(r)}function c(e,n,r){var t=s(e,n),o=t.indexOf(r);~o&&t.splice(o,1)}function f(e,r,o,i){if(r===n&&o===n)return function(n,r){return l(e,n,r)};"function"==typeof r&&(i=o,o=r,r=e,e="");var a=t(r);return[e,a,o,i]}function l(e,n,r,t){var o=f(e,n,r,t);r=o[2],t=o[3],r._keymage=t||{},r._keymage.original=n,u.apply(null,o)}var p,d="1.0.1",h="undefined"!=typeof navigator&&~navigator.userAgent.indexOf("Mac OS X"),v=["shiftKey","ctrlKey","altKey","metaKey"],g={shift:"shift",ctrl:"ctrl",control:"ctrl",alt:"alt",option:"alt",win:"meta",cmd:"meta","super":"meta",meta:"meta",defmod:h?"meta":"ctrl"},m=["shift","ctrl","alt","meta"],y=[16,17,18,91],k={backspace:8,tab:9,enter:13,"return":13,pause:19,caps:20,capslock:20,escape:27,esc:27,space:32,pgup:33,pageup:33,pgdown:34,pagedown:34,end:35,home:36,ins:45,insert:45,del:46,"delete":46,left:37,up:38,right:39,down:40,"*":106,"+":107,plus:107,"-":109,minus:109,";":186,"=":187,",":188,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222};for(p=0;10>p;p++)k["num-"+p]=p+95;for(p=0;10>p;p++)k[p.toString()]=p+48;for(p=1;25>p;p++)k["f"+p]=p+111;for(p=65;91>p;p++)k[String.fromCharCode(p).toLowerCase()]=p;var b={};for(var w in k){var x=k[w];(!b[x]||b[x].length<w.length)&&(b[x]=w)}var E="",C={},L=[];return l.unbind=function(e,n,r){var t=f(e,n,r);c.apply(null,t)},l.parse=e,l.stringify=r,l.bindings=C,l.setScope=function(e){E=e?e:""},l.getScope=function(){return E},l.pushScope=function(e){return E=(E?E+".":"")+e},l.popScope=function(e){var n;return e?(E=E.replace(new RegExp("(^|\\.)"+e+"(\\.|$).*"),""),e):(n=E.lastIndexOf("."),e=E.slice(n+1),E=-1==n?"":E.slice(0,n),e)},l.version=d,window.addEventListener("keydown",a,!1),l})}("undefined"!=typeof e?e:function(e){"undefined"!=typeof r?r.exports=e():window.keymage=e()})},{}]},{},[1])(1)});